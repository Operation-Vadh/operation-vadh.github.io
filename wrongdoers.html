<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Wrongdoers / Targets — Operation Vadh</title>
  <meta name="description" content="Public list of reported wrongdoers, platforms, crimes, criticality, and status. Contribute via GitHub Issues or email." />
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --muted:#9aa4b2; --accent:#4f46e5;
      --danger:#ef4444; --warning:#f59e0b; --success:#10b981;
      --glass: rgba(255,255,255,0.03);
      --radius:12px;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      color-scheme: dark;
    }
    *{box-sizing:border-box}
    body{
      margin:0; background:linear-gradient(180deg,#071025 0%, #081226 60%); color:#e6eef8;
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; padding:32px;
    }
    .container{max-width:1200px;margin:0 auto;}
    header{display:flex;align-items:center;gap:16px;margin-bottom:20px}
    .logo{
      width:56px;height:56px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#06b6d4);
      display:flex;align-items:center;justify-content:center;font-weight:700;color:white;font-size:20px;
      box-shadow:0 6px 20px rgba(79,70,229,0.15);
    }
    h1{margin:0;font-size:20px}
    p.lead{margin:4px 0 0;color:var(--muted);font-size:13px}
    .controls{display:flex;flex-wrap:wrap;gap:12px;margin:18px 0 22px;align-items:center}
    .search{flex:1;min-width:220px;display:flex;gap:8px}
    input, select, button{
      background:var(--glass);border:1px solid rgba(255,255,255,0.04);color:inherit;padding:10px 12px;border-radius:10px;
      font-size:14px;
    }
    button.primary{background:linear-gradient(90deg,var(--accent),#06b6d4);border:none;color:white;padding:10px 14px;cursor:pointer}
    .grid{display:grid;grid-template-columns:1fr 320px;gap:20px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); padding:16px;border-radius:var(--radius);box-shadow:0 6px 30px rgba(2,6,23,0.6)}
    table{width:100%;border-collapse:collapse;font-size:14px}
    thead th{font-weight:600;text-align:left;padding:10px 8px;color:var(--muted);font-size:12px;position:sticky;top:0;background:transparent}
    tbody tr{border-top:1px solid rgba(255,255,255,0.03)}
    td{padding:12px 8px;vertical-align:top}
    .name{font-weight:600;color:#fff}
    .meta{color:var(--muted);font-size:13px}
    .badge{display:inline-flex;align-items:center;gap:8px;padding:6px 8px;border-radius:999px;font-size:12px;font-weight:600}
    .b-low{background:rgba(16,185,129,0.08);color:var(--success)}
    .b-med{background:rgba(245,158,11,0.08);color:var(--warning)}
    .b-high{background:rgba(239,68,68,0.08);color:var(--danger)}
    .b-critical{background:linear-gradient(90deg,#ef4444 0%,#f97316 100%);color:white}
    .status-pending{background:rgba(255,255,255,0.03);color:var(--muted);border-radius:8px;padding:6px 8px;font-weight:600}
    .status-terminated{background:rgba(16,185,129,0.08);color:var(--success);border-radius:8px;padding:6px 8px;font-weight:600}
    .small{font-size:13px;color:var(--muted)}
    .sidebar h3{margin:4px 0 10px}
    .contribute{display:flex;flex-direction:column;gap:8px}
    a.link{color:var(--accent);text-decoration:none;font-weight:600}
    .footer-note{margin-top:12px;color:var(--muted);font-size:13px}
    .row{display:flex;gap:8px;align-items:center}
    .actions{display:flex;gap:8px}
    .btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:8px 10px;border-radius:8px;color:var(--muted);cursor:pointer}
    .empty{padding:28px;text-align:center;color:var(--muted)}
    .pagination{display:flex;gap:8px;align-items:center;justify-content:center;padding:12px}
    @media (max-width:980px){
      .grid{grid-template-columns:1fr; }
      header{flex-direction:column;align-items:flex-start}
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo" aria-hidden>OV</div>
      <div>
        <h1>Public Watchlist — Wrongdoers & Targets</h1>
        <p class="lead">Community-submitted reports: platform, crime description, criticality, and status. Use responsibly — follow law & ethics.</p>
      </div>
    </header>

    <div class="controls">
      <div class="search">
        <input id="q" type="search" placeholder="Search by name, platform, or crime (press Enter)" aria-label="Search wrongdoers" />
        <button id="searchBtn" class="btn-ghost">Search</button>
      </div>

      <select id="filterPlatform" aria-label="Filter by platform">
        <option value="">All platforms</option>
      </select>

      <select id="filterCriticality" aria-label="Filter by criticality">
        <option value="">All criticality</option>
        <option value="low">Low</option>
        <option value="medium">Medium</option>
        <option value="high">High</option>
        <option value="critical">Critical</option>
      </select>

      <select id="filterStatus" aria-label="Filter by status">
        <option value="">All status</option>
        <option value="pending">Pending</option>
        <option value="terminated">Terminated</option>
      </select>

      <div style="margin-left:auto" class="row">
        <button id="refresh" class="btn-ghost">Refresh</button>
        <a class="primary" id="newIssue" href="https://github.com/Operation-Vadh/operation-vadh.github.io/issues/new" target="_blank" rel="noopener noreferrer" style="text-decoration:none;margin-left:6px">Open Issue</a>
      </div>
    </div>

    <div class="grid">
      <div class="card">
        <div id="listArea" aria-live="polite">
          <table id="listTable" role="table" aria-label="Wrongdoers list">
            <thead>
              <tr>
                <th style="width:34%">Subject</th>
                <th style="width:24%">Platform / Crime</th>
                <th style="width:18%">Criticality</th>
                <th style="width:14%">Status</th>
                <th style="width:10%">Reported</th>
              </tr>
            </thead>
            <tbody id="listBody">
              <tr><td colspan="5" class="empty">Loading…</td></tr>
            </tbody>
          </table>
        </div>

        <div id="pagi" class="pagination" style="margin-top:12px"></div>
      </div>

      <aside class="card sidebar">
        <h3>Contribute / Update</h3>
        <div class="contribute">
          <div class="small">
            Two ways to submit updates:
            <ol style="padding-left:16px;margin:8px 0 0">
              <li>Open a GitHub Issue (preferred) — use the issue template (title + structured body).</li>
              <li>Email <strong>opvadh1@proton.me</strong> with subject "Report: [Name] — [Platform]" and include evidence links and timestamped details.</li>
            </ol>
          </div>

          <div>
            <strong>Issue template (copy into new issue body):</strong>
            <pre style="background:#071426;padding:8px;border-radius:8px;color:var(--muted);font-size:13px">
Title: Report: [Name or handle] — [Platform]

- Name/Handle:
- Platform(s):
- Crime / Behavior (clear, factual):
- Evidence (links / screenshots):
- Date(s) observed:
- Criticality: low / medium / high / critical
- Suggested action / request:
- Contact (optional):
            </pre>
          </div>

          <div class="footer-note">
            For maintainers: preferred data format is JSON at <code>/data/wrongdoers.json</code>. Contributions via pull request updating that file with well-sourced evidence are fastest to merge.
          </div>

          <div style="margin-top:10px;display:flex;gap:8px">
            <a class="btn-ghost" href="https://github.com/Operation-Vadh/operation-vadh.github.io" target="_blank" rel="noopener noreferrer">Repo</a>
            <a class="btn-ghost" href="mailto:opvadh1@proton.me">Email</a>
          </div>
        </div>

        <h3 style="margin-top:18px">Guiding principles</h3>
        <ul class="small" style="padding-left:16px;margin:8px 0 0">
          <li>Only publish verifiable, lawful reports.</li>
          <li>Respect privacy of unrelated parties.</li>
          <li>Provide evidence links where possible.</li>
          <li>We may remove or flag reports that lack corroboration.</li>
        </ul>
      </aside>
    </div>

    <footer style="margin-top:18px;color:var(--muted);font-size:13px">
      Note: This list is for community awareness and lawful action. Operation Vadh does not encourage harassment or illegal conduct. Use reports responsibly.
    </footer>
  </div>

  <script>
    // Config
    const DATA_URL = '/data/wrongdoers.json'; // relative path to data file in repo
    const PAGE_SIZE = 12;

    // State
    let data = [];
    let filtered = [];
    let currentPage = 1;

    const elements = {
      q: document.getElementById('q'),
      searchBtn: document.getElementById('searchBtn'),
      filterPlatform: document.getElementById('filterPlatform'),
      filterCriticality: document.getElementById('filterCriticality'),
      filterStatus: document.getElementById('filterStatus'),
      listBody: document.getElementById('listBody'),
      pagi: document.getElementById('pagi'),
      refresh: document.getElementById('refresh'),
    };

    // Utilities
    function formatDate(iso){
      if(!iso) return '';
      const d = new Date(iso);
      return isNaN(d) ? iso : d.toLocaleDateString();
    }

    function criticalBadge(level){
      const map = {
        low: 'b-low', medium: 'b-med', high: 'b-high', critical: 'b-critical'
      };
      const cls = map[(level||'').toLowerCase()] || 'b-low';
      return `<span class="badge ${cls}">${(level||'Unknown').toUpperCase()}</span>`;
    }

    function statusLabel(s){
      if(!s) return '<span class="status-pending">Unknown</span>';
      if(s.toLowerCase()==='terminated') return '<span class="status-terminated">Terminated</span>';
      return '<span class="status-pending">Pending</span>';
    }

    // Fetch and prepare
    async function loadData(){
      try{
        const res = await fetch(DATA_URL + '?v=' + Date.now(), {cache:'no-store'});
        if(!res.ok) throw new Error('Failed to load data');
        const json = await res.json();
        data = Array.isArray(json) ? json : (json.entries || []);
        // Normalize keys (example)
        data = data.map((x,i) => ({
          id: x.id || i+1,
          name: x.name || x.handle || 'Unknown',
          platform: x.platform || 'Unknown',
          crime: x.crime || x.description || '',
          criticality: (x.criticality||'low').toLowerCase(),
          status: (x.status||'pending').toLowerCase(),
          reported_at: x.reported_at || x.date_reported || '',
          evidence: x.evidence || x.evidence_url || '',
          notes: x.notes || ''
        }));
        populatePlatformFilter();
        applyFilters();
      }catch(err){
        elements.listBody.innerHTML = '<tr><td colspan="5" class="empty">Failed to load data. Please check /data/wrongdoers.json</td></tr>';
        console.error(err);
      }
    }

    function populatePlatformFilter(){
      const set = new Set(data.map(d => d.platform).filter(Boolean));
      elements.filterPlatform.innerHTML = '<option value="">All platforms</option>' + Array.from(set).map(s => `<option value="${escapeHtml(s)}">${escapeHtml(s)}</option>`).join('');
    }

    // Filtering / Searching
    function applyFilters(){
      const q = elements.q.value.trim().toLowerCase();
      const platform = elements.filterPlatform.value;
      const crit = elements.filterCriticality.value;
      const status = elements.filterStatus.value;

      filtered = data.filter(item => {
        if(platform && item.platform !== platform) return false;
        if(crit && item.criticality !== crit) return false;
        if(status && item.status !== status) return false;
        if(q){
          const hay = (item.name + ' ' + item.platform + ' ' + item.crime).toLowerCase();
          return hay.includes(q);
        }
        return true;
      });

      // Sort: by reported_at desc (most recent first) if present
      filtered.sort((a,b) => {
        const da = a.reported_at ? new Date(a.reported_at).getTime() : 0;
        const db = b.reported_at ? new Date(b.reported_at).getTime() : 0;
        return db - da;
      });

      currentPage = 1;
      renderList();
    }

    // Rendering
    function renderList(){
      const start = (currentPage-1)*PAGE_SIZE;
      const pageItems = filtered.slice(start, start+PAGE_SIZE);

      if(!pageItems.length){
        elements.listBody.innerHTML = '<tr><td colspan="5" class="empty">No results found.</td></tr>';
        elements.pagi.innerHTML = '';
        return;
      }

      elements.listBody.innerHTML = pageItems.map(item => {
        const name = escapeHtml(item.name);
        const platform = escapeHtml(item.platform);
        const crime = escapeHtml(item.crime).slice(0,220) + (item.crime && item.crime.length>220 ? '…' : '');
        const evidence = item.evidence ? `<div class="small"><a class="link" href="${escapeAttr(item.evidence)}" target="_blank" rel="noopener noreferrer">evidence</a></div>` : '';
        return `<tr>
          <td><div class="name">${name}</div><div class="meta">${escapeHtml(item.notes || '')}</div></td>
          <td><div class="meta">${platform}</div><div style="margin-top:6px">${escapeHtml(crime)}</div>${evidence}</td>
          <td>${criticalBadge(item.criticality)}</td>
          <td>${statusLabel(item.status)}</td>
          <td class="small">${formatDate(item.reported_at)}</td>
        </tr>`;
      }).join('');

      renderPagination();
    }

    function renderPagination(){
      const total = filtered.length;
      const pages = Math.max(1, Math.ceil(total / PAGE_SIZE));
      const parts = [];
      if(currentPage>1) parts.push(`<button class="btn-ghost" data-page="${currentPage-1}">Prev</button>`);
      parts.push(`<div style="color:var(--muted)">${total} result(s) — page ${currentPage} of ${pages}</div>`);
      if(currentPage<pages) parts.push(`<button class="btn-ghost" data-page="${currentPage+1}">Next</button>`);
      elements.pagi.innerHTML = parts.join('');
      elements.pagi.querySelectorAll('button[data-page]').forEach(btn => {
        btn.addEventListener('click', (e)=> {
          currentPage = Number(btn.dataset.page);
          renderList();
          window.scrollTo({top:0,behavior:'smooth'});
        });
      });
    }

    // Helpers
    function escapeHtml(s){ return (s===undefined || s===null) ? '' : String(s).replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }
    function escapeAttr(s){ return escapeHtml(s).replace(/"/g,'&quot;') }

    // Events
    elements.searchBtn.addEventListener('click', applyFilters);
    elements.refresh.addEventListener('click', loadData);
    elements.q.addEventListener('keydown', (e)=> { if(e.key==='Enter'){ applyFilters(); }});
    [elements.filterPlatform, elements.filterCriticality, elements.filterStatus].forEach(el => el.addEventListener('change', applyFilters));

    // Initial
    loadData();
  </script>
</body>
</html>
